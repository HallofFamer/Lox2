namespace test.lang
using clox.std.net.HTTPClient
using clox.std.net.HTTPRequest
using clox.std.net.URL

val client = HTTPClient()
println("Initializing HTTP Client: ${client}")
println("")

println("Sending get request to example.com: ")
val response = client.get(URL.parse("https://example.com"))
println("Status: ${response.status}")
println("Cookies: ${response.cookies}")
println("Content Type: ${response.contentType}")
println("Content: ")
println(response.content)
println("")

println("Sending post request to httpbin.com: ")
val response2 = client.post("https://httpbin.org/post", ["name" : "Ordland", "age": 34, "location" : "United States"])
println("Status: ${response2.status}")
println("Cookies: ${response2.cookies}")
println("Content Type: ${response2.contentType}")
println("Content: ")
println(response2.content)
println("")

println("Sending put request to httpbin.com: ")
val response3 = client.put("https://httpbin.org/put", ["id": 521, "name" : "Ordland", "age": 34, "location" : "United States"])
println("Status: ${response3.status}")
println("Cookies: ${response3.cookies}")
println("Content Type: ${response3.contentType}")
println("Content: ")
println(response3.content)
println("")

println("Sending delete request to httpbin.com: ")
val response4 = client.delete("https://httpbin.org/delete")
println("Status: ${response4.status}")
println("Cookies: ${response4.cookies}")
println("Content Type: ${response4.contentType}")
println("Content: ")
println(response4.content)
println("")


println("Sending patch request to httpbin.com: ")
val response5 = client.patch("https://httpbin.org/patch", ["name" : "Hall of Famer", "location" : "New Jersey, United States"])
println("Status: ${response5.status}")
println("Cookies: ${response5.cookies}")
println("Content Type: ${response5.contentType}")
println("Content: ")
println(response5.content)
println("")


println("Creating a HTTPRequest object: ")
val request = HTTPRequest("https://httpbin.org/post", HTTPRequest.httpPOST, ["Accept": "*/*", "Content-Type": "application/json"], ["name" : "Ordland", "age": 34, "location" : "United States"])
println(request.toString())
println("")

println("Sending generic HTTP request to example.com: ")
var response6 = client.send(request)
println("Status: ${response6.status}")
println("Cookies: ${response6.cookies}")
println("Content Type: ${response6.contentType}")
println("Content: ")
println(response6.content)
println("")

println("Closing HTTP Client... ")
client.close()